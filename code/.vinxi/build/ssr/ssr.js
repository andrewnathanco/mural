import{isServer as G,getRequestEvent as W,ssr as f,ssrHydrationKey as g,createComponent as y,ssrElement as v,escape as m,mergeProps as J,NoHydration as U,ssrAttribute as C,renderToString as Y,renderToStream as Q}from"solid-js/web";import{onCleanup as V,catchError as X,sharedConfig as E}from"solid-js";import{provideRequestEvent as Z}from"solid-js/web/storage";import{H3Event as A,setResponseStatus as ee,sendRedirect as te,setHeader as ne,getRequestIP as re,getResponseStatus as se,getResponseStatusText as oe,getRequestURL as ae,getResponseHeaders as ie,getResponseHeader as ce,setResponseHeader as le,appendResponseHeader as ue,removeResponseHeader as de,getRequestWebStream as pe,eventHandler as he}from"h3";import{AsyncLocalStorage as fe}from"node:async_hooks";const me=G?e=>{const t=W();return t.response.status=e.code,t.response.statusText=e.text,V(()=>!t.nativeEvent.handled&&!t.complete&&(t.response.status=200)),null}:e=>null;var ge=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">500 | Internal Server Error</span>'];const ye=e=>{let t=!1;const n=X(()=>e.children,r=>{console.error(r),t=!!r});return t?[f(ge,g()),y(me,{code:500})]:n};var Re=" ";const Se={style:e=>v("style",e.attrs,()=>m(e.children),!0),link:e=>v("link",e.attrs,void 0,!0),script:e=>e.attrs.src?v("script",J(()=>e.attrs,{get id(){return e.key}}),()=>f(Re),!0):null,noscript:e=>v("noscript",e.attrs,()=>m(e.children),!0)};function ve(e,t){let{tag:n,attrs:{key:r,...a}={key:void 0},children:i}=e;return Se[n]({attrs:{...a,nonce:t},key:r,children:i})}var N=["<script",">","<\/script>"],_=["<script",' type="module"',"><\/script>"];const we=f("<!DOCTYPE html>");function be(e){const t=W(),n=t.nonce;return y(U,{get children(){return[we,y(ye,{get children(){return y(e.document,{get assets(){return t.assets.map(r=>ve(r))},get scripts(){return n?[f(N,g()+C("nonce",m(n,!0),!1),`window.manifest = ${JSON.stringify(t.manifest)}`),f(_,g(),C("src",m(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]:[f(N,g(),`window.manifest = ${JSON.stringify(t.manifest)}`),f(_,g(),C("src",m(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]}})}})]}})}function Ce(e={}){let t,n=!1;const r=s=>{if(t&&t!==s)throw new Error("Context conflict")};let a;if(e.asyncContext){const s=e.AsyncLocalStorage||globalThis.AsyncLocalStorage;s?a=new s:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const i=()=>{if(a&&t===void 0){const s=a.getStore();if(s!==void 0)return s}return t};return{use:()=>{const s=i();if(s===void 0)throw new Error("Context is not available");return s},tryUse:()=>i(),set:(s,o)=>{o||r(s),t=s,n=!0},unset:()=>{t=void 0,n=!1},call:(s,o)=>{r(s),t=s;try{return a?a.run(s,o):o()}finally{n||(t=void 0)}},async callAsync(s,o){t=s;const l=()=>{t=s},c=()=>t===s?l:void 0;q.add(c);try{const d=a?a.run(s,o):o();return n||(t=void 0),await d}finally{q.delete(c)}}}}function Ee(e={}){const t={};return{get(n,r={}){return t[n]||(t[n]=Ce({...e,...r})),t[n],t[n]}}}const b=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},L="__unctx__",Te=b[L]||(b[L]=Ee()),Ae=(e,t={})=>Te.get(e,t),P="__unctx_async_handlers__",q=b[P]||(b[P]=new Set);function $e(e){let t;const n=B(e),r={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(n,{...r,body:e.node.req.body}):new Request(n,{...r,get body(){return t||(t=Oe(e),t)}})}function xe(e){return e.web??={request:$e(e),url:B(e)},e.web.request}function He(){return ke()}const F=Symbol("$HTTPEvent");function Ne(e){return typeof e=="object"&&(e instanceof A||e?.[F]instanceof A||e?.__is_event__===!0)}function u(e){return function(...t){let n=t[0];if(Ne(n))t[0]=n instanceof A||n.__is_event__?n:n[F];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(n=He(),!n)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");t.unshift(n)}return e(...t)}}const B=u(ae),_e=u(re),$=u(ee),D=u(se),Le=u(oe),w=u(ie),O=u(ce),Pe=u(le),qe=u(ue),j=u(te),De=u(ne),Oe=u(pe),je=u(de),Ie=u(xe);function Me(){return Ae("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:fe})}function ke(){return Me().use().event}const R={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function We(e={}){const t={options:e,rootNode:K(),staticRoutesMap:{}},n=r=>e.strictTrailingSlash?r:r.replace(/\/$/,"")||"/";if(e.routes)for(const r in e.routes)I(t,n(r),e.routes[r]);return{ctx:t,lookup:r=>Ue(t,n(r)),insert:(r,a)=>I(t,n(r),a),remove:r=>Fe(t,n(r))}}function Ue(e,t){const n=e.staticRoutesMap[t];if(n)return n.data;const r=t.split("/"),a={};let i=!1,s=null,o=e.rootNode,l=null;for(let c=0;c<r.length;c++){const d=r[c];o.wildcardChildNode!==null&&(s=o.wildcardChildNode,l=r.slice(c).join("/"));const S=o.children.get(d);if(S===void 0){if(o&&o.placeholderChildren.length>1){const p=r.length-c;o=o.placeholderChildren.find(h=>h.maxDepth===p)||null}else o=o.placeholderChildren[0]||null;if(!o)break;o.paramName&&(a[o.paramName]=d),i=!0}else o=S}return(o===null||o.data===null)&&s!==null&&(o=s,a[o.paramName||"_"]=l,i=!0),o?i?{...o.data,params:i?a:void 0}:o.data:null}function I(e,t,n){let r=!0;const a=t.split("/");let i=e.rootNode,s=0;const o=[i];for(const l of a){let c;if(c=i.children.get(l))i=c;else{const d=Be(l);c=K({type:d,parent:i}),i.children.set(l,c),d===R.PLACEHOLDER?(c.paramName=l==="*"?`_${s++}`:l.slice(1),i.placeholderChildren.push(c),r=!1):d===R.WILDCARD&&(i.wildcardChildNode=c,c.paramName=l.slice(3)||"_",r=!1),o.push(c),i=c}}for(const[l,c]of o.entries())c.maxDepth=Math.max(o.length-l,c.maxDepth||0);return i.data=n,r===!0&&(e.staticRoutesMap[t]=i),i}function Fe(e,t){let n=!1;const r=t.split("/");let a=e.rootNode;for(const i of r)if(a=a.children.get(i),!a)return n;if(a.data){const i=r.at(-1)||"";a.data=null,Object.keys(a.children).length===0&&a.parent&&(a.parent.children.delete(i),a.parent.wildcardChildNode=null,a.parent.placeholderChildren=[]),n=!0}return n}function K(e={}){return{type:e.type||R.NORMAL,maxDepth:0,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function Be(e){return e.startsWith("**")?R.WILDCARD:e[0]===":"||e==="*"?R.PLACEHOLDER:R.NORMAL}const z=[{page:!0,path:"/*404",filePath:"/Users/andrew/Documents/Dev/Projects/andrewnathanco/github/proj-ancgames/mural/code/src/routes/[...404].tsx"},{page:!0,path:"/",filePath:"/Users/andrew/Documents/Dev/Projects/andrewnathanco/github/proj-ancgames/mural/code/src/routes/index.tsx"},{page:!0,path:"/share",filePath:"/Users/andrew/Documents/Dev/Projects/andrewnathanco/github/proj-ancgames/mural/code/src/routes/share.tsx"}];Ke(z.filter(e=>e.page));function Ke(e){function t(n,r,a,i){const s=Object.values(n).find(o=>a.startsWith(o.id+"/"));return s?(t(s.children||(s.children=[]),r,a.slice(s.id.length)),n):(n.push({...r,id:a,path:a.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"")}),n)}return e.sort((n,r)=>n.path.length-r.path.length).reduce((n,r)=>t(n,r,r.path,r.path),[])}function ze(e,t){const n=Je.lookup(e);if(n&&n.route){const r=n.route[`$${t}`];return r===void 0?void 0:{handler:r,params:n.params}}}function Ge(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}const Je=We({routes:z.reduce((e,t)=>{if(!Ge(t))return e;let n=t.path.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"").replace(/\*([^/]*)/g,(r,a)=>`**:${a}`);if(/:[^/]*\?/g.test(n))throw new Error(`Optional parameters are not supported in API routes: ${n}`);if(e[n])throw new Error(`Duplicate API routes for "${n}" found at "${e[n].route.path}" and "${t.path}"`);return e[n]={route:t},e},{})}),T=Symbol("fetchEvent");function Ye(e){return{request:Ie(e),response:Xe(e),clientAddress:_e(e),locals:{},nativeEvent:e}}function Qe(e){if(!e[T]){const t=Ye(e);e[T]=t}return e[T]}class Ve{event;constructor(t){this.event=t}get(t){const n=O(this.event,t);return Array.isArray(n)?n.join(", "):n||null}has(t){return this.get(t)!==void 0}set(t,n){return Pe(this.event,t,n)}delete(t){return je(this.event,t)}append(t,n){qe(this.event,t,n)}getSetCookie(){const t=O(this.event,"Set-Cookie");return Array.isArray(t)?t:[t]}forEach(t){return Object.entries(w(this.event)).forEach(([n,r])=>t(Array.isArray(r)?r.join(", "):r,n,this))}entries(){return Object.entries(w(this.event)).map(([t,n])=>[t,Array.isArray(n)?n.join(", "):n])[Symbol.iterator]()}keys(){return Object.keys(w(this.event))[Symbol.iterator]()}values(){return Object.values(w(this.event)).map(t=>Array.isArray(t)?t.join(", "):t)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Xe(e){return{get status(){return D(e)},set status(t){$(e,t)},get statusText(){return Le(e)},set statusText(t){$(e,D(e),t)},headers:new Ve(e)}}const Ze=new Set([301,302,303,307,308]);function x(e){return e.status&&Ze.has(e.status)?e.status:302}function et(e,t,n={}){return he({handler:r=>{const a=Qe(r);return Z(a,async()=>{const i=ze(new URL(a.request.url).pathname,a.request.method);if(i){const h=(await i.handler.import())[a.request.method];a.params=i.params||{},E.context={event:a};const H=await h(a);if(H!==void 0)return H;if(a.request.method!=="GET")throw new Error(`API handler for ${a.request.method} "${a.request.url}" did not return a response.`)}const s=await t(a),o=typeof n=="function"?await n(s):{...n},l=o.mode||"stream";o.nonce&&(s.nonce=o.nonce);{const p=Y(()=>(E.context.event=s,e(s)),o);if(s.complete=!0,s.response&&s.response.headers.get("Location")){const h=x(s.response);return j(r,s.response.headers.get("Location"),h)}return p}if(o.onCompleteAll){const p=o.onCompleteAll;o.onCompleteAll=h=>{k(s)(h),p(h)}}else o.onCompleteAll=k(s);if(o.onCompleteShell){const p=o.onCompleteShell;o.onCompleteShell=h=>{M(s,r)(),p(h)}}else o.onCompleteShell=M(s,r);const c=Q(()=>(E.context.event=s,e(s)),o);if(s.response&&s.response.headers.get("Location")){const p=x(s.response);return j(r,s.response.headers.get("Location"),p)}if(l==="async")return c;const{writable:d,readable:S}=new TransformStream;return c.pipeTo(d),S})}})}function M(e,t){return()=>{if(e.response&&e.response.headers.get("Location")){const n=x(e.response);$(t,n),De(t,"Location",e.response.headers.get("Location"))}}}function k(e){return({write:t})=>{e.complete=!0;const n=e.response&&e.response.headers.get("Location");n&&t(`<script>window.location="${n}"<\/script>`)}}function tt(e,t){return et(e,nt,t)}async function nt(e){const t=globalThis.MANIFEST.client;return Object.assign(e,{manifest:await t.json(),assets:[...await t.inputs[t.handler].assets()],routes:[],complete:!1,$islands:new Set})}var rt=['<head><script defer data-domain="ancgames.com" src="https://plausible.io/js/script.js"><\/script><meta charset="utf-8"><link rel="icon" href="/favicon.ico">',"</head>"],st=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];const ut=tt(()=>y(be,{document:({assets:e,children:t,scripts:n})=>f(st,g(),y(U,{get children(){return f(rt,m(e))}}),m(t),m(n))}));export{ut as default};
